module RogueC

# Generated by Froley. Will not be overwritten; customize as desired.
$include "ScannerCore.rogue"

class Scanner : ScannerCore
  PROPERTIES
    beginning_of_line : ScannerLocation

  METHODS
    method init( file:File )
      prior.init( file )
      beginning_of_line = _scanner.location

    method init( filepath:String, content:String, line=1, column=1 )
      prior.init( filepath, content, line, column )

    method init( _filepath, _scanner )
      prior.init( _filepath, _scanner )
      beginning_of_line = _scanner.location

    method mark_beginning_of_line
      beginning_of_line = _scanner.location

    method process_comment
      local comment = buffer->String
      if (comment.contains("FIXME"))
        local cur_loc = _scanner.location
        _scanner.location = beginning_of_line

        buffer.clear
        while (_scanner.position < cur_loc.position)
          buffer.print( _scanner.read )
        endWhile
        comment = buffer->String

        local matches = comment.split('\n').[ discard( not $.contains("FIXME") ) ]
        forEach (match in matches)
          println "[FIXME][$:$] $"(File.filename(_filepath),beginning_of_line.line,match)
        endForEach
      endIf

endClass
